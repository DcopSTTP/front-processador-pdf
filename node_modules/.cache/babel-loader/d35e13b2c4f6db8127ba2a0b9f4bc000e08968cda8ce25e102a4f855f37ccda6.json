{"ast":null,"code":"import axios from \"axios\";\n\n//export const URL = 'http://192.168.1.101:3335';\nexport const URL = 'http://localhost:3335';\nconst instance = axios.create({\n  baseURL: URL,\n  timeout: 30000\n});\nconst isTokenExpired = () => {\n  const loginTime = localStorage.getItem('loginTime');\n  if (!loginTime) return true;\n  const now = new Date().getTime();\n  const twentyFourHours = 24 * 60 * 60 * 1000;\n  return now - parseInt(loginTime) > twentyFourHours;\n};\nconst forceLogout = () => {\n  localStorage.removeItem('userData');\n  localStorage.removeItem('isLoggedIn');\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('loginTime');\n  localStorage.removeItem('nome');\n  localStorage.removeItem('email');\n  localStorage.removeItem('cpf');\n  localStorage.removeItem('acesso');\n  window.location.href = '/login';\n};\ninstance.interceptors.response.use(response => response, error => {\n  if (error.response && error.response.status === 401) {\n    return Promise.reject(new Error('Sessão expirada. Você será redirecionado para o login.'));\n  }\n  return Promise.reject(error);\n});\ninstance.interceptors.request.use(config => {\n  const publicUrls = ['/auth/signin', '/auth/esqueci-a-senha', '/auth/redefinir-senha', '/auth/cadastro'];\n  const isPublicUrl = publicUrls.some(url => config.url.includes(url));\n  if (!isPublicUrl && isTokenExpired()) {\n    return Promise.reject(new Error('Sessão expirada'));\n  }\n  return config;\n}, error => Promise.reject(error));\nexport const api = async (endpoint, metodo, body, newHeaders) => {\n  const token = localStorage.getItem('access_token');\n  let headers = newHeaders ? newHeaders : {\n    'Content-Type': 'application/json'\n  };\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  return instance.request({\n    url: endpoint,\n    method: metodo,\n    data: body ? body : undefined,\n    headers: headers\n  });\n};\nconst post = async (url, data, headers) => {\n  return api(url, 'POST', data, headers);\n};\nconst postWithoutAuth = async (url, data, headers) => {\n  const defaultHeaders = headers ? headers : {\n    'Content-Type': 'application/json'\n  };\n  return instance.request({\n    url: url,\n    method: 'POST',\n    data: data,\n    headers: defaultHeaders\n  });\n};\nconst put = async (url, data, headers) => {\n  return api(url, 'PUT', data, headers);\n};\nconst get = async (url, config) => {\n  try {\n    const token = localStorage.getItem('access_token');\n    let requestHeaders = config !== null && config !== void 0 && config.headers ? config.headers : {};\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n    const requestConfig = {\n      headers: requestHeaders,\n      params: config === null || config === void 0 ? void 0 : config.params\n    };\n    const response = await instance.get(url, requestConfig);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      var _error$response;\n      throw (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data;\n    } else {\n      throw error;\n    }\n  }\n};\nconst deleteRequest = async (url, headers) => {\n  try {\n    const token = localStorage.getItem('access_token');\n    const requestHeaders = headers ? headers : {};\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n    const response = await instance.delete(url, {\n      headers: requestHeaders\n    });\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      var _error$response2;\n      throw (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data;\n    } else {\n      throw error;\n    }\n  }\n};\nconst postFormData = async (url, formData, headers) => {\n  try {\n    const token = localStorage.getItem('access_token');\n    let requestHeaders = headers ? headers : {\n      'Content-Type': 'multipart/form-data'\n    };\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n    const response = await instance.request({\n      url: url,\n      method: 'POST',\n      data: formData,\n      headers: requestHeaders\n    });\n    return {\n      data: response.data,\n      status: response.status\n    };\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      var _error$response3;\n      throw ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || error.message;\n    } else {\n      throw error;\n    }\n  }\n};\nexport const getImageUrl = endpoint => `${URL}${endpoint}`;\nexport { deleteRequest as delete, get, post, postFormData, postWithoutAuth, put };","map":{"version":3,"names":["axios","URL","instance","create","baseURL","timeout","isTokenExpired","loginTime","localStorage","getItem","now","Date","getTime","twentyFourHours","parseInt","forceLogout","removeItem","window","location","href","interceptors","response","use","error","status","Promise","reject","Error","request","config","publicUrls","isPublicUrl","some","url","includes","api","endpoint","metodo","body","newHeaders","token","headers","method","data","undefined","post","postWithoutAuth","defaultHeaders","put","get","requestHeaders","requestConfig","params","isAxiosError","_error$response","deleteRequest","delete","_error$response2","postFormData","formData","_error$response3","message","getImageUrl"],"sources":["/Users/lohuamalima/Desktop/sttp/ocorrencias-de-transito/src/service/HttpService.js"],"sourcesContent":["import axios from \"axios\";\n\n//export const URL = 'http://192.168.1.101:3335';\nexport const URL = 'http://localhost:3335';\nconst instance = axios.create({\n  baseURL: URL,\n  timeout: 30000,\n});\n\nconst isTokenExpired = () => {\n  const loginTime = localStorage.getItem('loginTime');\n  if (!loginTime) return true;\n   \n  const now = new Date().getTime();\n  const twentyFourHours = 24 * 60 * 60 * 1000; \n  \n  return (now - parseInt(loginTime)) > twentyFourHours;\n};\n\nconst forceLogout = () => {\n  localStorage.removeItem('userData');\n  localStorage.removeItem('isLoggedIn');\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('loginTime');\n  localStorage.removeItem('nome');\n  localStorage.removeItem('email');\n  localStorage.removeItem('cpf');\n  localStorage.removeItem('acesso');\n  window.location.href = '/login';\n};\ninstance.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response && error.response.status === 401) {\n      return Promise.reject(new Error('Sessão expirada. Você será redirecionado para o login.'));\n    }\n    return Promise.reject(error);\n  }\n);\ninstance.interceptors.request.use(\n  (config) => {\n    const publicUrls = ['/auth/signin', '/auth/esqueci-a-senha', '/auth/redefinir-senha', '/auth/cadastro'];\n    const isPublicUrl = publicUrls.some(url => config.url.includes(url));\n    if (!isPublicUrl && isTokenExpired()) {\n      return Promise.reject(new Error('Sessão expirada'));\n    }\n    \n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\nexport const api = async (endpoint, metodo, body, newHeaders) => {\n  const token = localStorage.getItem('access_token');\n\n  let headers = newHeaders ? newHeaders : { 'Content-Type': 'application/json' };\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n\n  return instance.request({\n    url: endpoint,\n    method: metodo,\n    data: body ? body : undefined,\n    headers: headers,\n  });\n};\n\nconst post = async (url, data, headers) => {\n  return api(url, 'POST', data, headers);\n};\n\nconst postWithoutAuth = async (url, data, headers) => {\n  const defaultHeaders = headers ? headers : { 'Content-Type': 'application/json' };\n  \n  return instance.request({\n    url: url,\n    method: 'POST',\n    data: data,\n    headers: defaultHeaders, \n  });\n};\n\nconst put = async (url, data, headers) => {\n  return api(url, 'PUT', data, headers);\n};\n\nconst get = async (url, config) => {\n  try {\n    const token = localStorage.getItem('access_token');\n\n    let requestHeaders = config?.headers ? config.headers : {};\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const requestConfig = { headers: requestHeaders, params: config?.params };\n    const response = await instance.get(url, requestConfig);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      throw error.response?.data;\n    } else {\n      throw error;\n    }\n  }\n};\n\nconst deleteRequest = async (url, headers) => {\n  try {\n    const token = localStorage.getItem('access_token');\n\n    const requestHeaders = headers ? headers : {};\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await instance.delete(url, { headers: requestHeaders });\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      throw error.response?.data;\n    } else {\n      throw error;\n    }\n  }\n};\n\nconst postFormData = async (url, formData, headers) => {\n  try {\n    const token = localStorage.getItem('access_token');\n\n    let requestHeaders = headers ? headers : { 'Content-Type': 'multipart/form-data' };\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await instance.request({\n      url: url,\n      method: 'POST',\n      data: formData,\n      headers: requestHeaders,\n    });\n\n    return {\n      data: response.data,\n      status: response.status,\n    };\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      throw error.response?.data || error.message;\n    } else {\n      throw error;\n    }\n  }\n};\n\nexport const getImageUrl = (endpoint) => `${URL}${endpoint}`;\n\nexport { deleteRequest as delete, get, post, postFormData, postWithoutAuth, put };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}