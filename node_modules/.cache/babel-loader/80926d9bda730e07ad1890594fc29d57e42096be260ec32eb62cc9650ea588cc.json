{"ast":null,"code":"// Handlers para o App component\nimport Swal from'sweetalert2';import{validateFile}from'./fileUtils';import{extractDataFromPDF,generateNewPDF,saveDataToBackend}from'./pdfUtils';export const createHandlers=(setError,setExtractedData,setUploading,setUploadedFile,setProcessing,fileInputRef,setDragActive,uploadedFile,extractedData,onViewDetails)=>{// Event Handlers\nconst handleDrag=e=>{e.preventDefault();e.stopPropagation();if(e.type===\"dragenter\"||e.type===\"dragover\"){setDragActive(true);}else if(e.type===\"dragleave\"){setDragActive(false);}};const handleDrop=e=>{e.preventDefault();e.stopPropagation();setDragActive(false);if(e.dataTransfer.files&&e.dataTransfer.files[0]){handleFile(e.dataTransfer.files[0]);}};const handleFileSelect=e=>{if(e.target.files&&e.target.files[0]){handleFile(e.target.files[0]);}};// File Operations\nconst handleFile=async file=>{setError('');setExtractedData(null);const validation=validateFile(file);if(!validation.isValid){setError(validation.errors[0]);return;}setUploading(true);setTimeout(()=>{setUploadedFile({name:file.name,size:file.size,type:file.type,lastModified:file.lastModified,file:file});setUploading(false);},1000);};const processPDF=async()=>{if(!(uploadedFile!==null&&uploadedFile!==void 0&&uploadedFile.file))return;setProcessing(true);setError('');try{const data=await extractDataFromPDF(uploadedFile.file);setExtractedData(data);}catch(err){setError('Erro ao processar PDF: '+err.message);}finally{setProcessing(false);}};const downloadReport=async()=>{if(!extractedData)return;try{await generateNewPDF(extractedData);}catch(err){setError('Erro ao gerar relat√≥rio: '+err.message);}};const saveToBackend=async dataToSave=>{// Se n√£o receber dados como par√¢metro, usar extractedData\nconst data=dataToSave||extractedData;if(!data)return;try{// Mostrar loading\nSwal.fire({title:'Salvando dados...',text:'Por favor, aguarde enquanto os dados s√£o enviados para o sistema.',allowOutsideClick:false,allowEscapeKey:false,showConfirmButton:false,didOpen:()=>{Swal.showLoading();}});const result=await saveDataToBackend(data);// Extrair informa√ß√µes do resultado para exibir\nconst ocorrencia=result.data||result;const numeroOcorrencia=ocorrencia.numeroOcorrencia||'N/A';const dataHora=ocorrencia.createdAt?new Date(ocorrencia.createdAt).toLocaleString('pt-BR'):'N/A';// Mostrar sucesso com detalhes e op√ß√£o de visualizar\nconst resultado=await Swal.fire({icon:'success',title:'Ocorr√™ncia Salva!',html:\"\\n          <div style=\\\"text-align: left; margin: 10px 0;\\\">\\n            <p><strong>N\\xFAmero:</strong> \".concat(numeroOcorrencia,\"</p>\\n            <p><strong>Salva em:</strong> \").concat(dataHora,\"</p>\\n            <p><strong>Status:</strong> Processada e armazenada no sistema</p>\\n          </div>\\n        \"),showCancelButton:true,confirmButtonText:'üëÅÔ∏è Visualizar Dados',cancelButtonText:'OK',confirmButtonColor:'#3b82f6',cancelButtonColor:'#10b981',width:'500px',reverseButtons:true});// Se o usu√°rio escolheu visualizar os dados\nif(resultado.isConfirmed&&ocorrencia.id){// Chamar callback para navegar para detalhes (ser√° passado pelo componente pai)\nif(onViewDetails){onViewDetails(ocorrencia.id);}}}catch(err){// Mostrar erro\nSwal.fire({icon:'error',title:'Erro ao salvar',text:err.message||'Ocorreu um erro ao tentar salvar os dados no sistema.',confirmButtonText:'OK',confirmButtonColor:'#ef4444'});setError('Erro ao salvar dados: '+err.message);}};const removeFile=()=>{setUploadedFile(null);setExtractedData(null);setError('');if(fileInputRef.current){fileInputRef.current.value='';}};const openFileDialog=()=>{if(fileInputRef.current){fileInputRef.current.value='';fileInputRef.current.click();}};return{handleDrag,handleDrop,handleFileSelect,handleFile,processPDF,downloadReport,saveToBackend,removeFile,openFileDialog};};","map":{"version":3,"names":["Swal","validateFile","extractDataFromPDF","generateNewPDF","saveDataToBackend","createHandlers","setError","setExtractedData","setUploading","setUploadedFile","setProcessing","fileInputRef","setDragActive","uploadedFile","extractedData","onViewDetails","handleDrag","e","preventDefault","stopPropagation","type","handleDrop","dataTransfer","files","handleFile","handleFileSelect","target","file","validation","isValid","errors","setTimeout","name","size","lastModified","processPDF","data","err","message","downloadReport","saveToBackend","dataToSave","fire","title","text","allowOutsideClick","allowEscapeKey","showConfirmButton","didOpen","showLoading","result","ocorrencia","numeroOcorrencia","dataHora","createdAt","Date","toLocaleString","resultado","icon","html","concat","showCancelButton","confirmButtonText","cancelButtonText","confirmButtonColor","cancelButtonColor","width","reverseButtons","isConfirmed","id","removeFile","current","value","openFileDialog","click"],"sources":["/Users/lohuamalima/Desktop/sttp/ocorrencias-de-transito/src/utils/handlers.js"],"sourcesContent":["// Handlers para o App component\nimport Swal from 'sweetalert2';\nimport { validateFile } from './fileUtils';\nimport { extractDataFromPDF, generateNewPDF, saveDataToBackend } from './pdfUtils';\n\nexport const createHandlers = (\n  setError,\n  setExtractedData,\n  setUploading,\n  setUploadedFile,\n  setProcessing,\n  fileInputRef,\n  setDragActive,\n  uploadedFile,\n  extractedData,\n  onViewDetails\n) => {\n  // Event Handlers\n  const handleDrag = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFile(e.dataTransfer.files[0]);\n    }\n  };\n\n  const handleFileSelect = (e) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFile(e.target.files[0]);\n    }\n  };\n\n  // File Operations\n  const handleFile = async (file) => {\n    setError('');\n    setExtractedData(null);\n    \n    const validation = validateFile(file);\n    if (!validation.isValid) {\n      setError(validation.errors[0]);\n      return;\n    }\n\n    setUploading(true);\n    \n    setTimeout(() => {\n      setUploadedFile({\n        name: file.name,\n        size: file.size,\n        type: file.type,\n        lastModified: file.lastModified,\n        file: file\n      });\n      setUploading(false);\n    }, 1000);\n  };\n\n  const processPDF = async () => {\n    if (!uploadedFile?.file) return;\n    \n    setProcessing(true);\n    setError('');\n    \n    try {\n      const data = await extractDataFromPDF(uploadedFile.file);\n      setExtractedData(data);\n    } catch (err) {\n      setError('Erro ao processar PDF: ' + err.message);\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const downloadReport = async () => {\n    if (!extractedData) return;\n    \n    try {\n      await generateNewPDF(extractedData);\n    } catch (err) {\n      setError('Erro ao gerar relat√≥rio: ' + err.message);\n    }\n  };\n\n  const saveToBackend = async (dataToSave) => {\n    // Se n√£o receber dados como par√¢metro, usar extractedData\n    const data = dataToSave || extractedData;\n    if (!data) return;\n    \n    try {\n      // Mostrar loading\n      Swal.fire({\n        title: 'Salvando dados...',\n        text: 'Por favor, aguarde enquanto os dados s√£o enviados para o sistema.',\n        allowOutsideClick: false,\n        allowEscapeKey: false,\n        showConfirmButton: false,\n        didOpen: () => {\n          Swal.showLoading();\n        }\n      });\n\n      const result = await saveDataToBackend(data);\n      \n      // Extrair informa√ß√µes do resultado para exibir\n      const ocorrencia = result.data || result;\n      const numeroOcorrencia = ocorrencia.numeroOcorrencia || 'N/A';\n      const dataHora = ocorrencia.createdAt ? new Date(ocorrencia.createdAt).toLocaleString('pt-BR') : 'N/A';\n      \n      // Mostrar sucesso com detalhes e op√ß√£o de visualizar\n      const resultado = await Swal.fire({\n        icon: 'success',\n        title: 'Ocorr√™ncia Salva!',\n        html: `\n          <div style=\"text-align: left; margin: 10px 0;\">\n            <p><strong>N√∫mero:</strong> ${numeroOcorrencia}</p>\n            <p><strong>Salva em:</strong> ${dataHora}</p>\n            <p><strong>Status:</strong> Processada e armazenada no sistema</p>\n          </div>\n        `,\n        showCancelButton: true,\n        confirmButtonText: 'üëÅÔ∏è Visualizar Dados',\n        cancelButtonText: 'OK',\n        confirmButtonColor: '#3b82f6',\n        cancelButtonColor: '#10b981',\n        width: '500px',\n        reverseButtons: true\n      });\n\n      // Se o usu√°rio escolheu visualizar os dados\n      if (resultado.isConfirmed && ocorrencia.id) {\n        // Chamar callback para navegar para detalhes (ser√° passado pelo componente pai)\n        if (onViewDetails) {\n          onViewDetails(ocorrencia.id);\n        }\n      }\n      \n    } catch (err) {\n      \n      // Mostrar erro\n      Swal.fire({\n        icon: 'error',\n        title: 'Erro ao salvar',\n        text: err.message || 'Ocorreu um erro ao tentar salvar os dados no sistema.',\n        confirmButtonText: 'OK',\n        confirmButtonColor: '#ef4444'\n      });\n      \n      setError('Erro ao salvar dados: ' + err.message);\n    }\n  };\n\n  const removeFile = () => {\n    setUploadedFile(null);\n    setExtractedData(null);\n    setError('');\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const openFileDialog = () => {\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n      fileInputRef.current.click();\n    }\n  };\n\n  return {\n    handleDrag,\n    handleDrop,\n    handleFileSelect,\n    handleFile,\n    processPDF,\n    downloadReport,\n    saveToBackend,\n    removeFile,\n    openFileDialog\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}