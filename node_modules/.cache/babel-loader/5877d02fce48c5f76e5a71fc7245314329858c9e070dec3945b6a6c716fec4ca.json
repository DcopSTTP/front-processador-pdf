{"ast":null,"code":"import axios from\"axios\";//export const URL = 'http://192.168.1.101:3335';\nexport const URL='http://localhost:3335';const instance=axios.create({baseURL:URL,timeout:30000});const isTokenExpired=()=>{const loginTime=localStorage.getItem('loginTime');if(!loginTime)return true;const now=new Date().getTime();const twentyFourHours=24*60*60*1000;return now-parseInt(loginTime)>twentyFourHours;};const forceLogout=()=>{localStorage.removeItem('userData');localStorage.removeItem('isLoggedIn');localStorage.removeItem('access_token');localStorage.removeItem('loginTime');localStorage.removeItem('nome');localStorage.removeItem('email');localStorage.removeItem('cpf');localStorage.removeItem('acesso');window.location.href='/login';};instance.interceptors.response.use(response=>response,error=>{if(error.response&&error.response.status===401){return Promise.reject(new Error('Sessão expirada. Você será redirecionado para o login.'));}return Promise.reject(error);});instance.interceptors.request.use(config=>{const publicUrls=['/auth/signin','/auth/esqueci-a-senha','/auth/redefinir-senha','/auth/cadastro'];const isPublicUrl=publicUrls.some(url=>config.url.includes(url));if(!isPublicUrl&&isTokenExpired()){return Promise.reject(new Error('Sessão expirada'));}return config;},error=>Promise.reject(error));export const api=async(endpoint,metodo,body,newHeaders)=>{const token=localStorage.getItem('access_token');let headers=newHeaders?newHeaders:{'Content-Type':'application/json'};if(token){headers['Authorization']=\"Bearer \".concat(token);}return instance.request({url:endpoint,method:metodo,data:body?body:undefined,headers:headers});};const post=async(url,data,headers)=>{return api(url,'POST',data,headers);};const postWithoutAuth=async(url,data,headers)=>{const defaultHeaders=headers?headers:{'Content-Type':'application/json'};return instance.request({url:url,method:'POST',data:data,headers:defaultHeaders});};const put=async(url,data,headers)=>{return api(url,'PUT',data,headers);};const get=async(url,config)=>{try{const token=localStorage.getItem('access_token');let requestHeaders=config!==null&&config!==void 0&&config.headers?config.headers:{};if(token){requestHeaders['Authorization']=\"Bearer \".concat(token);}const requestConfig={headers:requestHeaders,params:config===null||config===void 0?void 0:config.params};const response=await instance.get(url,requestConfig);return response.data;}catch(error){if(axios.isAxiosError(error)){var _error$response;throw(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data;}else{throw error;}}};const deleteRequest=async(url,headers)=>{try{const token=localStorage.getItem('access_token');const requestHeaders=headers?headers:{};if(token){requestHeaders['Authorization']=\"Bearer \".concat(token);}const response=await instance.delete(url,{headers:requestHeaders});return response.data;}catch(error){if(axios.isAxiosError(error)){var _error$response2;throw(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data;}else{throw error;}}};const postFormData=async(url,formData,headers)=>{try{const token=localStorage.getItem('access_token');let requestHeaders=headers?headers:{'Content-Type':'multipart/form-data'};if(token){requestHeaders['Authorization']=\"Bearer \".concat(token);}const response=await instance.request({url:url,method:'POST',data:formData,headers:requestHeaders});return{data:response.data,status:response.status};}catch(error){if(axios.isAxiosError(error)){var _error$response3;throw((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.data)||error.message;}else{throw error;}}};export const getImageUrl=endpoint=>\"\".concat(URL).concat(endpoint);export{deleteRequest as delete,get,post,postFormData,postWithoutAuth,put};","map":{"version":3,"names":["axios","URL","instance","create","baseURL","timeout","isTokenExpired","loginTime","localStorage","getItem","now","Date","getTime","twentyFourHours","parseInt","forceLogout","removeItem","window","location","href","interceptors","response","use","error","status","Promise","reject","Error","request","config","publicUrls","isPublicUrl","some","url","includes","api","endpoint","metodo","body","newHeaders","token","headers","concat","method","data","undefined","post","postWithoutAuth","defaultHeaders","put","get","requestHeaders","requestConfig","params","isAxiosError","_error$response","deleteRequest","delete","_error$response2","postFormData","formData","_error$response3","message","getImageUrl"],"sources":["/Users/lohuamalima/Desktop/sttp/ocorrencias-de-transito/src/service/HttpService.js"],"sourcesContent":["import axios from \"axios\";\n\n//export const URL = 'http://192.168.1.101:3335';\nexport const URL = 'http://localhost:3335';\nconst instance = axios.create({\n  baseURL: URL,\n  timeout: 30000,\n});\n\nconst isTokenExpired = () => {\n  const loginTime = localStorage.getItem('loginTime');\n  if (!loginTime) return true;\n   \n  const now = new Date().getTime();\n  const twentyFourHours = 24 * 60 * 60 * 1000; \n  \n  return (now - parseInt(loginTime)) > twentyFourHours;\n};\n\nconst forceLogout = () => {\n  localStorage.removeItem('userData');\n  localStorage.removeItem('isLoggedIn');\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('loginTime');\n  localStorage.removeItem('nome');\n  localStorage.removeItem('email');\n  localStorage.removeItem('cpf');\n  localStorage.removeItem('acesso');\n  window.location.href = '/login';\n};\ninstance.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response && error.response.status === 401) {\n      return Promise.reject(new Error('Sessão expirada. Você será redirecionado para o login.'));\n    }\n    return Promise.reject(error);\n  }\n);\ninstance.interceptors.request.use(\n  (config) => {\n    const publicUrls = ['/auth/signin', '/auth/esqueci-a-senha', '/auth/redefinir-senha', '/auth/cadastro'];\n    const isPublicUrl = publicUrls.some(url => config.url.includes(url));\n    if (!isPublicUrl && isTokenExpired()) {\n      return Promise.reject(new Error('Sessão expirada'));\n    }\n    \n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\nexport const api = async (endpoint, metodo, body, newHeaders) => {\n  const token = localStorage.getItem('access_token');\n\n  let headers = newHeaders ? newHeaders : { 'Content-Type': 'application/json' };\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n\n  return instance.request({\n    url: endpoint,\n    method: metodo,\n    data: body ? body : undefined,\n    headers: headers,\n  });\n};\n\nconst post = async (url, data, headers) => {\n  return api(url, 'POST', data, headers);\n};\n\nconst postWithoutAuth = async (url, data, headers) => {\n  const defaultHeaders = headers ? headers : { 'Content-Type': 'application/json' };\n  \n  return instance.request({\n    url: url,\n    method: 'POST',\n    data: data,\n    headers: defaultHeaders, \n  });\n};\n\nconst put = async (url, data, headers) => {\n  return api(url, 'PUT', data, headers);\n};\n\nconst get = async (url, config) => {\n  try {\n    const token = localStorage.getItem('access_token');\n\n    let requestHeaders = config?.headers ? config.headers : {};\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const requestConfig = { headers: requestHeaders, params: config?.params };\n    const response = await instance.get(url, requestConfig);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      throw error.response?.data;\n    } else {\n      throw error;\n    }\n  }\n};\n\nconst deleteRequest = async (url, headers) => {\n  try {\n    const token = localStorage.getItem('access_token');\n\n    const requestHeaders = headers ? headers : {};\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await instance.delete(url, { headers: requestHeaders });\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      throw error.response?.data;\n    } else {\n      throw error;\n    }\n  }\n};\n\nconst postFormData = async (url, formData, headers) => {\n  try {\n    const token = localStorage.getItem('access_token');\n\n    let requestHeaders = headers ? headers : { 'Content-Type': 'multipart/form-data' };\n    if (token) {\n      requestHeaders['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await instance.request({\n      url: url,\n      method: 'POST',\n      data: formData,\n      headers: requestHeaders,\n    });\n\n    return {\n      data: response.data,\n      status: response.status,\n    };\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      throw error.response?.data || error.message;\n    } else {\n      throw error;\n    }\n  }\n};\n\nexport const getImageUrl = (endpoint) => `${URL}${endpoint}`;\n\nexport { deleteRequest as delete, get, post, postFormData, postWithoutAuth, put };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}